setwd("C:\\Users\\kjain307\\Documents\\GitHub\\INST737-UniversityOfMaryland-DataScience-H1BAnalysis\\Milestone2\\encoding")
dataset<-read.csv('onehotenc_clean.csv')
columns<-names(dataset)
#View(dataset)
df <- data.frame(dataset)
df$AGENT_PRESENT_0.0 <- as.factor(df$AGENT_PRESENT_0.0)
df$AGENT_PRESENT_1.0 <- as.factor(df$AGENT_PRESENT_1.0)
#df$AGENT_PRESENT_nan <- as.factor(df$AGENT_PRESENT_nan)
df$OCCUPATION <- as.factor(df$OCCUPATION)
df$CASE_STATUS_0.0 <- as.factor(df$CASE_STATUS_0.0)
df$CASE_STATUS_1.0 <- as.factor(df$CASE_STATUS_1.0)
#df$CASE_STATUS_nan <- as.factor(df$CASE_STATUS_nan)
#df$AGENT_PRESENT <- as.factor(df$AGENT_PRESENT)
#df$CASE_STATUS <- as.factor(df$CASE_STATUS)
#df$WILLFUL_VIOLATOR <- as.factor(df$WILLFUL_VIOLATOR)
#df$EMPLOYER_STATE <- as.factor(df$EMPLOYER_STATE)
#df$WORKSITE_STATE <- as.factor(df$WORKSITE_STATE)
smp_size <- floor(0.80 * nrow(df))
set.seed(123)
train_generator <- sample(seq_len(nrow(df)),size=smp_size)
train <- df[train_generator,]
test<- df[-train_generator,]
modelMul <- lm(train$HOURLY_WAGE~train$WAGE_RATE_OF_PAY_FROM_HOUR+train$AGENT_PRESENT_0.0+train$OCCUPATION)
summary(modelMul)
modelMul <- lm(train$HOURLY_WAGE~train$WAGE_RATE_OF_PAY_FROM_HOUR+train$OCCUPATION)
summary(modelMul)
modelMul <- lm(train$HOURLY_WAGE~train$WAGE_RATE_OF_PAY_FROM_HOUR)
summary(modelMul)
modelMul <- lm(train$HOURLY_WAGE~train$WAGE_RATE_OF_PAY_FROM_HOUR+train$AGENT_PRESENT_0.0)
summary(modelMul)
modelMul <- lm(train$HOURLY_WAGE~train$WAGE_RATE_OF_PAY_FROM_HOUR+train$OCCUPATION)
summary(modelMul)
modelAP <- lm(train$HOURLY_WAGE~train$AGENT_PRESENT_0.0)
summary(modelMul)
fitMul = data.frame(train,fitted.value=fitted(modelMul),residual=resid(modelMul))
View(fitMul)
qqnorm(resid(modelMul))
qqline(resid(modelMul))
modelMul <- lm(train$HOURLY_WAGE~train$WAGE_RATE_OF_PAY_FROM_HOUR+train$OCCUPATION+train$AGENT_PRESENT_0.0)
install.packages("car")
library(car)
install.packages('zip')
library(car)
install.packages("car",ddependencies = TRUE)
library(car)
install.packages("cellranger",ddependencies = TRUE)
library(car)
prediction <- predict(modelMul,newdata = test)
attach(train)
modelMul2 <- lm(HOURLY_WAGE~.,data=train)
prediction <- predict(model,newdata=test)
prediction <- predict(modelMul2,newdata=test)
cor(prediction,test$HOURLY_WAGE)
library(glmnet)
